# Top Half과 Bottom Half

하드웨어 인터럽트가 발생했다고 가정해보자. 그렇다면 보통 다음과 같은 처리가 이루어진다.

1. interrupt disable
2. 하드웨어 인터럽트 관련 처리
3. interrupt enable

인터럽트가 발생하면, 우선 다른 인터럽트를 받지 못하게 인터럽트 기능 자체를 disable 상태로 만든다. 따라서 지금 발생한 하드웨어 인터럽트를 처리할 수 있고, 이와 관련된 처리가 모두 완료되면 그제서야 인터럽트 기능을 enable한다.

큰 문제가 없어보이지만 인터럽트 처리가 복잡하여 시간이 길어지면 그동안 시스템을 사용할 수 없기 때문에 사용에 불편함을 느낄 수 있다. 예를 들어 특정 인터럽트가 발생했는데 해당 인터럽트에 1초가 걸렸다고 하자. 그 동안에는 사용자가 키보드 입력도 할 수 없고, 마우스도 움직이지 않는다. 이런 문제를 해결하기 위해, **Top Half**와 **Bottom Half** 라는 개념이 등장하게 되었다.

이 개념은 '인터럽트가 발생했을때 데이터를 가져오는 등 반드시 바로 처리해야하거나 빠른 시간 내에 끝낼 수 있는 일은 바로 하고 다음에 해야할 일은 나중에 처리하자'라는 개념이다. 여기서 `먼저 하는 일은 Top Half`, `나중에 하는 일을 Bottom Half`라고 부르자고 하였다. (Window NT 계열에서는 `Deferred Procedure Call` , Asynchronous Procedure Call` 등의 용어를 사용한다.)

따라서 인터럽트가 발생하면 Top Half부터 얼른 처리하므로 앞서 예를 들었던 1초간 멈춤 현상등은 잘 나타나지 않을 것이다.

그렇다면 Bottom Half는 언제 처리할까?

## Bottom half의 처리

여러가지 기능이 있다고 하는데 대표적인 것이 work_queue이다. work_queue는 커널이 제공하는 기본 기능이며, work. 즉, function들을 work_queue에 넣어 차례대로 호출하여 Bottom half를 처리하게 된다.
